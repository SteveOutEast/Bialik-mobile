!function(){window.App=Ember.Application.create({LOG_STACKTRACE_ON_DEPRECATION:!1,LOG_BINDINGS:!1,LOG_TRANSITIONS:!1,LOG_TRANSITIONS_INTERNAL:!1,LOG_VIEW_LOOKUPS:!1,LOG_ACTIVE_GENERATION:!1})}(),function(){App.CONFIG={env:"dev",api:{checkUrl:"http://bialik.icconsultants.ca/api/location",url:"https://bialik-mobile.azurewebsites.net/api",DEVICE_ID_HEADER:"X-Device-Id",AUTH_TOKEN_HEADER:"X-Authorization-Token"},bbPush:{INVOKE_TARGET_ID:"bialik.pushreceiver.invoke.push",BLACKBERRY_PUSH_APPLICATION_ID:"4280-6h3B579k4D69tR0865r681DD419a44r9251",BLACKBERRY_PUSH_URL:"http://pushapi.eval.blackberry.com",HTTPS_GO_URBANAIRSHIP_COM_API_DEVICE_PINS:"https://go.urbanairship.com/api/device_pins/",HTTPS_GO_URBANAIRSHIP_COM_API_TAGS:"https://go.urbanairship.com/api/tags/",URBAN_AIRSHIP_APPKEY:"NqAd3TwYSsasEO9PJJ0sVw",URBAN_AIRSHIP_APPSECRET:"CPuk5156R4SusYAJcmVNQA"},URL_IMG_BASE:"images/"}}(),function(){function a(){this._listeners={},this._mutators={}}var b=a,c=b.prototype;c.on=function(a,b){return(this._listeners[a]=this._listeners[a]||[]).push(b),this},c.mutate=function(a,b){return this._mutators[a]=b,this},c.once=function(a,b){function c(){b.apply(this,[].slice.call(arguments)),d.remove(a,c)}var d=this;return d.on(a,c)},c.emit=function(a){var b=this._listeners[a]||[],c=[].slice.call(arguments,1),d=this._mutators[a]||function(){return[].slice.call(arguments)};c=d.apply(null,c),b.forEach(function(a){a.apply(null,c)})},c.listeners=function(a){return this._listeners[a]||[]},c.removeListener=c.remove=function(a,b){var c=this._listeners[a]||[];"function"==typeof b?c.indexOf(b)>-1&&c.splice(c.indexOf(b),1):delete this._listeners[a]};var d=function(){this.event_emitter=new a};d.prototype.notificationType={none:0,badge:1,sound:2,alert:4},d.prototype.failure=function(a){console.log("Javascript Callback Error: "+a)},d.prototype.call_native=function(a,b,c){return 2==arguments.length&&(c=[]),ret=cordova.exec(a,this.failure,"PushNotificationPlugin",b,c)},d.prototype.isPlatformIOS=function(){return"iPhone"==device.platform||"iPad"==device.platform||"iPod touch"==device.platform||"iOS"==device.platform},d.prototype.registerForNotificationTypes=function(a,b){("iPhone"==device.platform||"iPad"==device.platform||"iPod touch"==device.platform||"iOS"==device.platform)&&this.call_native(b,"registerForNotificationTypes",[a])},d.prototype.enablePush=function(a){this.call_native(a,"enablePush")},d.prototype.disablePush=function(a){this.call_native(a,"disablePush")},d.prototype.enableLocation=function(a){this.call_native(a,"enableLocation")},d.prototype.disableLocation=function(a){this.call_native(a,"disableLocation")},d.prototype.enableBackgroundLocation=function(a){this.call_native(a,"enableBackgroundLocation")},d.prototype.disableBackgroundLocation=function(a){this.call_native(a,"disableBackgroundLocation")},d.prototype.isPushEnabled=function(a){this.call_native(a,"isPushEnabled")},d.prototype.isSoundEnabled=function(a){"Android"==device.platform&&this.call_native(a,"isSoundEnabled")},d.prototype.isVibrateEnabled=function(a){"Android"==device.platform&&this.call_native(a,"isVibrateEnabled")},d.prototype.isQuietTimeEnabled=function(a){this.call_native(a,"isQuietTimeEnabled")},d.prototype.isInQuietTime=function(a){this.call_native(a,"isInQuietTime")},d.prototype.isLocationEnabled=function(a){this.call_native(a,"isLocationEnabled")},d.prototype.isBackgroundLocationEnabled=function(a){this.call_native(a,"isBackgroundLocationEnabled")},d.prototype.getIncoming=function(a){this.call_native(a,"getIncoming")},d.prototype.getPushID=function(a){this.call_native(a,"getPushID")},d.prototype.getQuietTime=function(a){this.call_native(a,"getQuietTime")},d.prototype.getTags=function(a){this.call_native(a,"getTags")},d.prototype.getAlias=function(a){this.call_native(a,"getAlias")},d.prototype.setAlias=function(a,b){this.call_native(b,"setAlias",[a])},d.prototype.setTags=function(a,b){this.call_native(b,"setTags",[a])},d.prototype.setSoundEnabled=function(a,b){"Android"==device.platform&&this.call_native(b,"setSoundEnabled",[a])},d.prototype.setVibrateEnabled=function(a,b){"Android"==device.platform&&this.call_native(b,"setVibrateEnabled",[a])},d.prototype.setQuietTimeEnabled=function(a,b){this.call_native(b,"setQuietTimeEnabled",[a])},d.prototype.setQuietTime=function(a,b,c,d,e){this.call_native(e,"setQuietTime",[a,b,c,d])},d.prototype.setAutobadgeEnabled=function(a,b){this.isPlatformIOS()&&this.call_native(b,"setAutobadgeEnabled",[a])},d.prototype.setBadgeNumber=function(a,b){this.isPlatformIOS()&&this.call_native(b,"setBadgeNumber",[a])},d.prototype.resetBadge=function(a){this.isPlatformIOS()&&this.call_native(a,"resetBadge")},d.prototype.recordCurrentLocation=function(a){this.call_native(a,"recordCurrentLocation")},d.prototype.registerEvent=function(a,b){this.event_emitter.on(a,b)},d.prototype.pushCallback=function(a){this.event_emitter.emit("push",a)},d.prototype.registrationCallback=function(a){error=!a.valid,pushID=a.pushID,this.event_emitter.emit("registration",error,pushID)},d.install=function(){return window.plugins||(window.plugins={}),window.plugins.pushNotification=new d,window.plugins.pushNotification},window.cordova&&cordova.addConstructor(d.install)}(),function(){!function(a,b){function c(a){localStorage.setItem("device:receivePN",a)}function d(c,d,e){var f={device_pins:{}};f.device_pins[e?"add":"remove"]=[c],f=JSON.stringify(f),b.each(d,function(){var c=a.CONFIG.bbPush.HTTPS_GO_URBANAIRSHIP_COM_API_TAGS+encodeURI(this);b.ajax({url:c,method:"POST",data:f,contentType:"application/json",beforeSend:function(b){b.setRequestHeader("Authorization","Basic "+window.btoa(a.CONFIG.bbPush.URBAN_AIRSHIP_APPKEY+":"+a.CONFIG.bbPush.URBAN_AIRSHIP_APPSECRET))},success:function(a,b,c){console.log("Urban Airship TAGS: "+c.responseText,c.status)},error:function(a){console.log("ERROR "+a.responseText,a.status)}})})}var e=function(){var a=localStorage.getItem("device:tags")||"[]",b=localStorage.getItem("device:token")||"",c=localStorage.getItem("device:receivePN")||"1";this.tags=JSON.parse(a),this.receivePN=c,this.token=b,this.init()};e.prototype.tags=[],e.prototype.token="",e.prototype.createChannelCallback=function(b,c){var d;this.token=c,localStorage.setItem("device:token",c),b===blackberry.push.PushService.SUCCESS?(d=new XMLHttpRequest,d.open("PUT",a.CONFIG.bbPush.HTTPS_GO_URBANAIRSHIP_COM_API_DEVICE_PINS+c,!0),d.onload=function(){console.log("Urban Airship: "+this.response)},d.onerror=function(a){console.log("ERROR "+a.responseText)},d.setRequestHeader("Authorization","Basic "+window.btoa(a.CONFIG.bbPush.URBAN_AIRSHIP_APPKEY+":"+a.CONFIG.bbPush.URBAN_AIRSHIP_APPSECRET)),d.send()):console.log("createChannelCallback: "+b)},e.prototype.setTags=function(a){this.tags.length>0&&d(this.token,this.tags,!1),1==this.receivePN&&d(this.token,a,!0),this.tags=a,localStorage.setItem("device:tags",JSON.stringify(this.tags))},e.prototype.enablePush=function(){d(this.token,this.tags,!0),this.receivePN="1",c("1")},e.prototype.disablePush=function(){d(this.token,this.tags,!1),this.receivePN="0",c("0")},e.prototype.createPushServiceSuccess=function(a){var b=this;this.service=a,blackberry.event.addEventListener("invoked",function(a){var c=b.service.extractPushPayload(a),d=new FileReader;d.onload=function(a){blackberry.ui.dialog.customAskAsync(a.target.result,["Close Notification"],function(){},{title:"Notification"})},d.onerror=function(){},d.readAsText(c.data,"UTF-8")}),this.service.createChannel(function(a,c){b.createChannelCallback.call(b,a,c)})},e.prototype.createPushServiceError=function(a){console.log("PUSH ERROR",a)},e.prototype.simChangeCallback=function(){console.log("SIM CHANGED")},e.prototype.pushTransportReadyCallback=function(){console.log("PUSH TRANSPORT READY")},e.prototype.init=function(){var b=this;blackberry.push.PushService.create({invokeTargetId:a.CONFIG.bbPush.INVOKE_TARGET_ID,appId:a.CONFIG.bbPush.BLACKBERRY_PUSH_APPLICATION_ID,ppgUrl:a.CONFIG.bbPush.BLACKBERRY_PUSH_URL},function(a){b.createPushServiceSuccess.call(b,a)},this.createPushServiceError,this.simChangeCallback,this.pushTransportReadyCallback)},a.BbPush=e}(window.App,jQuery)}(),function(){function a(){}a.prototype.createEvent=function(a,b,c,d,e,f,g){return"function"!=typeof g?void console.log("calendarPlugin.createEvent failure: errorCallback parameter must be a function"):"function"!=typeof f?void console.log("calendarPlugin.createEvent failure: successCallback parameter must be a function"):void cordova.exec(f,g,"calendarPlugin","createEvent",[a,b,c,d,e])},a.prototype.deleteEvent=function(a,b,c,d,e,f,g,h){return"function"!=typeof h?void console.log("calendarPlugin.deleteEvent failure: errorCallback parameter must be a function"):"function"!=typeof g?void console.log("calendarPlugin.deleteEvent failure: successCallback parameter must be a function"):void cordova.exec(g,h,"calendarPlugin","deleteEvent",[a,b,c,d,e,f])},a.prototype.findEvent=function(a,b,c,d,e,f,g){return"function"!=typeof g?void console.log("calendarPlugin.findEvent failure: errorCallback parameter must be a function"):"function"!=typeof f?void console.log("calendarPlugin.findEvent failure: successCallback parameter must be a function"):void cordova.exec(f,g,"calendarPlugin","findEvent",[a,b,c,d,e])},a.prototype.modifyEvent=function(a,b,c,d,e,f,g,h,i,j,k,l){return"function"!=typeof l?void console.log("calendarPlugin.modifyEvent failure: errorCallback parameter must be a function"):"function"!=typeof k?void console.log("calendarPlugin.modifyEvent failure: successCallback parameter must be a function"):void cordova.exec(k,l,"calendarPlugin","modifyEvent",[a,b,c,d,e,f,g,h,i,j])},a.install=function(){return window.plugins||(window.plugins={}),window.plugins.calendarPlugin=new a,window.plugins.calendarPlugin}}(),function(){function a(){}a.prototype.createEvent=function(a,b,c,d,e,f,g){return"function"!=typeof g?void console.log("calendarPlugin.createEvent failure: errorCallback parameter must be a function"):"function"!=typeof f?void console.log("calendarPlugin.createEvent failure: successCallback parameter must be a function"):void cordova.exec(f,g,"calendarPlugin","addToCalendar",[{title:a,description:c,eventLocation:b,startTimeMillis:d.getTime(),endTimeMillis:e.getTime()}])},a.prototype.deleteEvent=function(){throw"NotImplemented"},a.prototype.findEvent=function(){throw"NotImplemented"},a.prototype.modifyEvent=function(){throw"NotImplemented"},a.install=function(){return window.plugins||(window.plugins={}),window.plugins.calendarPlugin=new a,window.plugins.calendarPlugin}}(),function(){window.blackberry&&("object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}())}(),function(){Ember.Handlebars.helper("formatPrice",function(a){return a>0?"$"+a:"Free"})}(),function(){Ember.Handlebars.helper("getTime",function(a){return moment.parseZone(a).format("MMM D, h:mm a")})}(),function(){Ember.Handlebars.helper("schoolLink",function(a){var b="http://"+a;return new Handlebars.SafeString('<a target="_blank" href="'+b+'">'+a+"</a>")})}(),function(){Ember.Handlebars.helper("shortDate",function(a){return $.fullCalendar.formatDate(new Date(a),"MMM dd, yyyy")})}(),function(){App.Ajax=Em.Mixin.create({sendRequest:function(a,b,c,d){$.ajax({crossDomain:!0,url:a,method:b.method||"GET",context:this,data:b.data||{},success:c||function(){},error:d||function(){}})},sendRequestPromised:function(a,b){return $.ajax({crossDomain:!0,url:a,method:b.method||"GET",context:this,data:b.data||{}})}})}(),function(){App.SchoolImage=Em.Mixin.create({schoolImg:function(){return this.getCurrentImage()}.property(),getCurrentImage:function(){return App.CONFIG.URL_IMG_BASE+"welcome-school-"+this.getSchoolId()+".jpg"},getSchoolId:function(){return this.controllerFor("application").get("locationId")},updateSchoolImg:function(){this.set("schoolImg",this.getCurrentImage())}})}(),function(){App.SendMail=Em.Mixin.create(App.Ajax,{sendMail:function(a,b,c){var d=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},e=App.CONFIG.api.url+"/email/"+c,f={method:"POST",data:{from:a,body:b}};f.data[App.CONFIG.api.DEVICE_ID_HEADER]=d.deviceId||"",f.data.schoolId=d.locationId||0,this.sendRequest(e,f,this.handleEmailSuccess,this.handleEmailError)},handleEmailSuccess:function(){this.setSuccess()},handleEmailError:function(){this.setError()}})}(),function(){App.StaticContent=Em.Mixin.create(App.Ajax,{needs:["application"],content:"",updateContent:function(){var a=localStorage.getItem("content-"+this.get("contentId"))||"",b={method:"POST",data:{}};this.set("content",a),b.data[App.CONFIG.api.DEVICE_ID_HEADER]=this.get("controllers.application").get("deviceId"),b.data.schoolId=this.get("controllers.application").get("locationId"),this.sendRequest(App.CONFIG.api.url+"/content/"+this.get("contentId"),b,this.handleUpdatedContent)},saveContent:function(){localStorage.setItem("content-"+this.get("contentId"),this.get("content"))},handleUpdatedContent:function(a){this.set("content",a),this.saveContent()}})}(),function(){App.Book=Ember.Model.extend({month:Ember.attr(),title:Ember.attr(),image:Ember.attr(),resource:Ember.attr(),published:Ember.attr(),price:Ember.attr(Number),currency:Ember.attr(),link:Ember.attr(),description:Ember.attr()}),App.Book.store=[],App.Book.adapter=Ember.Adapter.createWithMixins(App.Ajax,{findAll:function(a,b){var c=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},d=App.CONFIG.api.url+"/books",e={method:"POST",data:{}};e.data[App.CONFIG.api.DEVICE_ID_HEADER]=c.deviceId||"",e.data.schoolId=c.locationId,this.sendRequestPromised(d,e).then(function(c){this.store=c,b.load(a,c)})}})}(),function(){App.Contact=Ember.Model.extend({name:Ember.attr(),title:Ember.attr(),email:Ember.attr(),phone:Ember.attr(),ext:Ember.attr(),currentOnly:Ember.attr(),isPrimary:Ember.attr()}),App.Contact.store=[],App.Contact.adapter=Ember.Adapter.createWithMixins(App.Ajax,{findAll:function(a,b){var c=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},d=App.CONFIG.api.url+"/schoolInfo",e={method:"POST",data:{}};e.data[App.CONFIG.api.DEVICE_ID_HEADER]=c.deviceId||"",c.token&&(e.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=c.token),e.data.schoolId=c.locationId||0,this.sendRequestPromised(d,e).then(function(c){b.load(a,c.contacts)})},findQuery:function(a,b,c){var d=$.grep(App.Contact.store,function(a){return a.currentOnly===c.currentOnly});b.load(a,d)}})}(),function(){App.Event=Ember.Model.extend({title:Ember.attr(),start:Ember.attr(),end:Ember.attr(),classes:Ember.attr(),location:Ember.attr(),description:Ember.attr(),lat:Ember.attr(),"long":Ember.attr(),url:Ember.attr()}),App.Event.store=[],App.Event.adapter=Ember.Adapter.createWithMixins(App.Ajax,{findAll:function(a,b){var c=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},d=App.CONFIG.api.url+"/calendar",e={method:"POST",data:{}};e.data[App.CONFIG.api.DEVICE_ID_HEADER]=c.deviceId||"",e.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=c.token||"",this.sendRequestPromised(d,e).then(function(c){var d=[];$.each(c,function(){var a={title:this.title,start:moment(this.start),end:moment(this.end),classes:this.classes,location:this.location,description:this.description,lat:this.lat,"long":this.long,url:this.url};d.push(a)}),b.load(a,c),App.Event.store=c,$("#calendar").fullCalendar("addEventSource",d)})},findQuery:function(a,b,c){App.Event.store.length<1&&App.Event.find();var d=$.grep(App.Event.store,function(a){return moment(a.start).format("YYYY-MM-DD")===c.date});b.load(a,d)}})}(),function(){App.JotForm=Ember.Model.extend({id:Ember.attr(),title:Ember.attr(),link:Ember.attr()}),App.JotForm.store=[],App.JotForm.adapter=Ember.Adapter.createWithMixins(App.Ajax,{findAll:function(a,b){var c=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},d=App.CONFIG.api.url+"/JotForms",e={method:"POST",data:{}};e.data.schoolId=c.locationId,e.data[App.CONFIG.api.DEVICE_ID_HEADER]=c.deviceId||"",c.token&&(e.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=c.token),this.sendRequestPromised(d,e).then(function(c){this.store=c,b.load(a,c)})}})}(),function(){App.Pta=Ember.Model.extend({id:Ember.attr(),name:Ember.attr(),link:Ember.attr()}),App.Pta.adapter=Ember.Adapter.createWithMixins(App.Ajax,{findAll:function(a,b){var c=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},d=App.CONFIG.api.url+"/ptadocs",e={method:"POST",data:{}};e.data[App.CONFIG.api.DEVICE_ID_HEADER]=c.deviceId||"",e.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=c.token||"",e.data.schoolId=c.locationId,this.sendRequestPromised(d,e).then(function(c){b.load(a,c)})}})}(),function(){App.PtaMessage=Ember.Model.extend({id:Ember.attr(),title:Ember.attr(),sections:Ember.attr()}),App.PtaMessage.adapter=Ember.Adapter.createWithMixins(App.Ajax,{findAll:function(a,b){var c=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},d=App.CONFIG.api.url+"/ptamessages",e={method:"POST",data:{}};e.data[App.CONFIG.api.DEVICE_ID_HEADER]=c.deviceId||"",e.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=c.token||"",this.sendRequestPromised(d,e).then(function(c){b.load(a,c)})}})}(),function(){App.SchoolModel=Ember.Model.extend({locationId:Ember.attr(Number),name:Ember.attr(),address:Ember.attr(),phone:Ember.attr(),fax:Ember.attr(),web:Ember.attr(),img:Ember.attr()}),App.SchoolModel.adapter=Ember.FixtureAdapter.create({findQuery:function(a,b,c){var d=$.grep(App.SchoolModel.FIXTURES,function(a){return a.locationId==c.locationId});b.load(a,d)}}),App.SchoolModel.FIXTURES=[{id:"Viewmount Branch",locationId:1,name:"Viewmount Branch",address:"2760 Bathurst St.<br />Toronto, Ontario<br />M6B 3A1 Canada",phone:"416-783-3346",fax:"416-785-8287",web:"www.bialik.ca",img:"images/contact-viewmount.jpg"},{id:"The Ben and Edith Himel Education Centre",locationId:2,name:"The Ben and Edith Himel Education Centre",address:"180 Ilan Ramon Boulevard<br />Vaughan, Ontario<br />L6A 4P6  Canada",phone:"905-417-3737",fax:"905-417-0606",web:"www.bialik.ca",img:"  images/contact-tbehec.jpg"}]}(),function(){App.Video=Ember.Model.extend({title:Ember.attr(),thumbnail:Ember.attr(),content:Ember.attr(),link:Ember.attr()}),App.Video.adapter=Ember.Adapter.create({findAll:function(a,b){$.getJSON("http://gdata.youtube.com/feeds/api/users/UCyglP4lKw3UImH-yzqrKQNg/uploads?alt=json").then(function(c){var d=[];$.each(c.feed.entry,function(a,b){var c={};c.title=b.title.$t,c.thumbnail=b.media$group.media$thumbnail[0].url,c.content=b.content.$t,c.link=b.link[0].href,d.push(c)}),b.load(a,d)})}})}(),function(){App.AuthenticatedRoute=Ember.Route.extend({application:null,init:function(){this._super(),this.application=this.controllerFor("application")},beforeModel:function(){var a=this.application.get("token");a||(alert("Not Authorized, Please Sign In"),this.transitionTo("setup.requestLogin"))}})}(),function(){App.ApplicationInfoRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("pageTitle","Application & Info")}})}(),function(){App.ApplicationInfoApplicationFormRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("hasSideNav",!1),this.controllerFor("prospective").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("prospective").set("hasSideNav",!0),this.controllerFor("prospective").set("hasBackBtn",!1)}})}(),function(){App.ApplicationInfoBrochureRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("hasSideNav",!1),this.controllerFor("prospective").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("prospective").set("hasSideNav",!0),this.controllerFor("prospective").set("hasBackBtn",!1)}})}(),function(){App.ApplicationInfoFeesRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("hasSideNav",!1),this.controllerFor("prospective").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("prospective").set("hasSideNav",!0),this.controllerFor("prospective").set("hasBackBtn",!1)}})}(),function(){App.ApplicationInfoGrades1To5Route=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("hasSideNav",!1),this.controllerFor("prospective").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("prospective").set("hasSideNav",!0),this.controllerFor("prospective").set("hasBackBtn",!1)}})}(),function(){App.ApplicationInfoGrades6To8Route=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("hasSideNav",!1),this.controllerFor("prospective").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("prospective").set("hasSideNav",!0),this.controllerFor("prospective").set("hasBackBtn",!1)}})}(),function(){App.ApplicationInfoKindergartenRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("hasSideNav",!1),this.controllerFor("prospective").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("prospective").set("hasSideNav",!0),this.controllerFor("prospective").set("hasBackBtn",!1)}})}(),function(){App.ApplicationRoute=Ember.Route.extend(App.Ajax,{isPushSetup:!1,events:{triggerBack:function(){history.back()},loadUrl:function(a){window.loadUrl(a)},openPDF:function(a){window.open(a,"_blank")},signOut:function(){this.controller.set("isLoading",!0),this.controllerFor("settings").setProperties({signoutError:!1,message:""}),this.registerSignout(this.signoutSuccess,this.signoutError)},signIn:function(){this.controllerFor("application").set("loggingIn",!0),this.transitionTo("setup.requestLogin")}},init:function(){},activate:function(){var a=this;$("body").on("click","#pta-tab a",function(a){a.preventDefault(),$(this).tab("show")}),this.isPushSetup||(!window.cordova||"Android"!==window.device.platform&&"iOS"!==window.device.platform||(window.calPlugin=window.plugins.calendarPlugin,window.push=window.plugins.pushNotification,setTimeout(function(){window.push.getIncoming(function(b){a.handlePush.call(a,b,!0)})},1e3),document.addEventListener("resume",function(){window.push.getIncoming(function(b){a.handlePush.call(a,b,!0)})},!1)),this.isPushSetup=!0)},signoutSuccess:function(){this.controller.setProperties({token:null,authToken:null,parentType:"prospective"}),this.controllerFor("settings").set("parentType","prospective"),this.controllerFor("user").resetSettings(),this.controller.resetConfig(),this.transitionTo("index"),setTimeout(function(){window.location.reload()},250)},signoutError:function(){this.controllerFor("settings").setProperties({signoutError:!0,message:"There was an error signing you out. Make sure you have network connection and try again. This is for security purposes."}),this.controller.set("isLoading",!1)},registerSignout:function(a,b){var c={method:"POST",data:{}};c.data[App.CONFIG.api.DEVICE_ID_HEADER]=this.controller.get("deviceId"),c.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=this.controller.get("token"),this.sendRequest(App.CONFIG.api.url+"/signout",c,a,b)},handlePush:function(a,b){var c=(a.message,a.extras),d={ptamessages:"current.pta",ptadocs:"current.pta",newsletter:"current.newsletter",calendar:"calendar",books:"bookRecommendations",safearrival:"current.safeArrival",contacts:"current.contact"};if(c.type&&b){var e=c.type.toLowerCase(),f=d[e]||"";("ptadocs"===e||"ptamessages"===e)&&this.controllerFor("currentPta").setProperties({isDocs:"ptadocs"===e?!0:!1,isMsgs:"ptamessages"===e?!0:!1}),this.transitionTo(f)}}})}(),function(){App.BookRecommendationsBookRoute=Ember.Route.extend({model:function(a){return App.Book.find(parseInt(a.book_id))},activate:function(){var a=this.controllerFor("prospective");a.set("pageTitle","Book Recommendations"),a.set("hasSideNav",!1),a.set("hasBackBtn",!0)}})}(),function(){App.BookRecommendationsIndexRoute=Ember.Route.extend({model:function(){return App.Book.find()},activate:function(){var a=this.controllerFor("prospective");a.set("pageTitle","Book Recommendations"),a.set("hasSideNav",!0),a.set("hasBackBtn",!1)}})}(),function(){App.CalendarDayRoute=Ember.Route.extend({model:function(a){return App.Event.find({date:a.date})},setupController:function(a,b){"string"==typeof b&&this.controller.set("content",App.Event.find({date:b}))},activate:function(){var a=this.controllerFor("current");a.set("pageTitle","Calendar"),a.set("hasSideNav",!0),a.set("hasBackBtn",!1)}})}(),function(){App.CalendarRoute=Ember.Route.extend({model:function(){return App.Event.find()},activate:function(){var a=this.controllerFor("current");a.set("pageTitle","Calendar"),a.set("hasSideNav",!0),a.set("hasBackBtn",!1)}})}(),function(){App.CurrentRoute=App.AuthenticatedRoute.extend({events:{loadPage:function(a){this.controller.toggleProperty("navOpen"),this.transitionTo(a)},toggleNav:function(){this.controller.toggleProperty("navOpen")},newsletterBack:function(){this.controllerFor("current").setProperties({newsletterBackBtn:!1,hasSideNav:!0}),this.controllerFor("current.newsletter").set("category",null)},ptaTabClicked:function(a){this.controllerFor("currentPta").setProperties("docs"===a?{isDocs:!0,isMsgs:!1}:{isDocs:!1,isMsgs:!0})}}})}(),function(){App.CurrentContactRoute=Ember.Route.extend({model:function(){return App.Contact.find()},activate:function(){this.controllerFor("currentContact").get("content",this.model().reload()),this.controllerFor("current").set("pageTitle","Contact")}})}(),function(){App.CurrentHomeRoute=Ember.Route.extend({activate:function(){this.controllerFor("current").set("pageTitle","Home"),this.controllerFor("currentHome").updateSchoolImg()}})}(),function(){App.CurrentJotFormRoute=Ember.Route.extend({model:function(){return App.JotForm.find()},activate:function(){this.controllerFor("current").set("pageTitle","School Forms")}})}(),function(){App.CurrentNewsletterRoute=Ember.Route.extend({activate:function(){this.controllerFor("current").set("pageTitle","Newsletter")},deactivate:function(){this.controllerFor("current").setProperties({newsletterBackBtn:!1,hasSideNav:!0}),this.controller.set("category",null)}})}(),function(){App.CurrentPtaRoute=Ember.Route.extend({model:function(){return App.Pta.find()},activate:function(){var a=this.controllerFor("currentPta").get("isDocs");this.controllerFor("current").setProperties({pageTitle:"PTA Info",showPtaNav:!0}),setTimeout(function(){a?$('#pta-tab a[href="#docs"]').tab("show"):$('#pta-tab a[href="#messages"]').tab("show")},100)},deactivate:function(){this.controllerFor("current").set("showPtaNav",!1)}})}(),function(){App.CurrentSafeArrivalRoute=Ember.Route.extend({activate:function(){var a=this.controllerFor("user");this.controllerFor("current").set("pageTitle","Safe Arrival"),this.controllerFor("current.safeArrival").setProperties({children:a.get("children"),parentName:a.get("parentName"),success:!1,error:!1}),1===this.controllerFor("application").get("config").locationId?this.controllerFor("current.safeArrival").set("errorMsg","Your message has NOT been sent. Please try again or contact us directly by phone at 416-783-3346 x5."):this.controllerFor("current.safeArrival").set("errorMsg","Your message has NOT been sent. Please try again or contact us directly by phone at 905-417-3737 x5.")}})}(),function(){App.EventsEventRoute=Ember.Route.extend(App.Ajax,{icsMsg:"",icsPath:"",activate:function(){var a=this.controllerFor("current");a.set("hasSideNav",!1),a.set("hasBackBtn",!0)},events:{saveEvent:function(a){var b=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},c=(App.CONFIG.api.url+"/ical",{method:"POST",data:{calId:a.get("id")}}),d=parseInt(window.device.version+"");if(c.data[App.CONFIG.api.DEVICE_ID_HEADER]=b.deviceId||"",c.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=b.token||"",window.calPlugin&&"Android"===window.device.platform)window.calPlugin.createEvent(a.get("title"),a.get("location"),"",moment.parseZone(a.get("start")).toDate(),moment.parseZone(a.get("end")).toDate(),function(){alert("Event Saved")},function(){alert("Failed to Save Event")});else if(window.calPlugin&&"iOS"===window.device.platform){var e=a.get("title"),f=a.get("location"),g="",h=moment.parseZone(a.get("start")).format("YYYY-MM-DD HH:mm:ss")+"",i=moment.parseZone(a.get("end")).format("YYYY-MM-DD HH:mm:ss")+"";window.calPlugin.createEvent(e,f,g,h,i,function(){},function(){navigator.alert("There was an issue saving this event to the calendar.",function(){},"Oops")})}else if("BlackBerry"===window.device.platform&&d>=10){var j,k=blackberry.pim.calendar;j=k.createEvent({summary:a.get("title"),location:a.get("location"),start:moment.parseZone(a.get("start")).toDate(),end:moment.parseZone(a.get("end")).toDate()}),j.save(function(){alert("Event saved to device. Look in your calendar to view.")},function(a){alert("Error saving event to device: "+a.code)})}else"BlackBerry"===window.device.platform&&10>d&&alert("Sorry this feature is not available on this device")}}})}(),function(){App.IndexRoute=Ember.Route.extend({redirect:function(){{var a=this;this.controllerFor("application").get("parentType")}a.transitionTo("setup")}})}(),function(){App.LoginRoute=Ember.Route.extend({activate:function(){this.controllerFor("login").setProperties({authError:!1,password:""})},events:{triggerBack:function(){this.controllerFor("application").set("authToken",null),this.transitionTo("setup.requestLogin")
}}})}(),function(){App.ProspectiveRoute=Ember.Route.extend({events:{loadPage:function(a){this.controller.toggleProperty("navOpen"),this.transitionTo(a)},toggleNav:function(){this.controller.toggleProperty("navOpen")}}})}(),function(){App.ProspectiveContactRoute=Ember.Route.extend({model:function(){return App.Contact.find()},activate:function(){this.controllerFor("prospective").set("pageTitle","Contact")}})}(),function(){App.ProspectiveHomeRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("pageTitle","Home")}})}(),function(){App.ProspectiveSchoolLifeRoute=Ember.Route.extend({model:function(){return App.Video.find()},activate:function(){this.controllerFor("prospective").set("pageTitle","School Life")}})}(),function(){App.ProspectiveWelcomeRoute=Ember.Route.extend({activate:function(){this.controllerFor("prospective").set("pageTitle","Welcome")}})}(),function(){App.PtaMessageRoute=Ember.Route.extend({model:function(a){return App.Book.find(parseInt(a.id))},activate:function(){this.controllerFor("current").set("hasSideNav",!1),this.controllerFor("current").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("current").set("hasSideNav",!0),this.controllerFor("current").set("hasBackBtn",!1)}})}(),function(){App.SetupLocationSelectRoute=Ember.Route.extend({model:function(){return App.SchoolModel.find()},events:{setLocation:function(a){var b=this.controllerFor("application"),c=this.controllerFor("user");b.setProperties({location:a.id,locationId:a.get("locationId")}),this.transitionTo("prospective.home"),c.setUATags(["PP"+a.get("locationId")])}},activate:function(){this.controllerFor("setup").set("hasBackBtn",!0)},deactivate:function(){this.controllerFor("setup").set("hasBackBtn",!1)}})}(),function(){App.SetupRequestLoginRoute=Ember.Route.extend({activate:function(){this.controllerFor("setup").set("hasBackBtn",!0),this.controllerFor("setup.requestLogin").setProperties({message:null,email:""})},deactivate:function(){this.controllerFor("setup").set("hasBackBtn",!1)},events:{triggerBack:function(){this.transitionTo("setup.parentType")}}})}(),function(){App.SetupRoute=Ember.Route.extend({redirect:function(){var a=this.controllerFor("application").get("config");this.transitionTo(a.parentType&&"prospective"===a.parentType&&!a.location?"setup.locationSelect":a.parentType&&!a.authToken?"prospective"!==a.parentType||this.controllerFor("application").get("loggingIn")?"setup.requestLogin":"prospective.home":a.authToken&&!a.token?"login":a.token?a.parentType+".home":"setup.parentType")},events:{prospectiveParent:function(){this.controllerFor("application").set("parentType","prospective"),this.transitionTo("setup.locationSelect")},currentParent:function(){this.controllerFor("application").set("parentType","current"),this.transitionTo("setup.requestLogin")}}})}(),function(){App.StaticContentController=Ember.ObjectController.extend(App.StaticContent,{init:function(){this._super(),this.updateContent()}})}(),function(){App.ApplicationController=Ember.ObjectController.extend(App.Ajax,{config:{},location:null,locationId:0,parentType:null,authToken:null,token:null,receivePushNotifications:!0,deviceId:null,platform:null,platformVersion:null,isLoading:!1,loggingIn:!1,init:function(){this._super(),this.setupConfig(),this.getDeviceInformation()},handlePageChanged:function(){var a=this.get("currentPath");$(".page article").scrollTop(0),"undefined"!=typeof cordova&&"iOS"===device.platform&&parseInt(device.version)>=7&&("setup.requestLogin"===a||"login"===a||"current.safeArrival"===a||"contact"===a?$('meta[name="viewport"]').attr("content","user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi"):$('meta[name="viewport"]').attr("content","width=device-width, target-densitydpi=device-dpi, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"))}.observes("currentPath"),getDeviceInformation:function(){window.cordova?("BlackBerry"===this.platform?parseInt(device.version)<10?this.set("deviceId",device.uuid):this.set("deviceId",blackberry.identity.IMEI||blackberry.identity.IMSI):this.set("deviceId",device.uuid),this.set("platform",device.platform),this.set("platformVersion",device.version)):(this.set("deviceId","790E6585-CF4A-44D6-AB03-4F25D2D50D29"),this.set("platform","web"),this.set("platformVersion","local-development")),this.registerDevice()},registerDevice:function(){var a={method:"POST",dataType:"jsonpi",data:{deviceId:this.get("deviceId"),platform:this.get("platform"),platformVersion:this.get("platformVersion")}};console.log("DEVICE ID"),console.log(a.data.deviceId),console.log("PLATFORM"),console.log(a.data.platform),console.log("PLATFORM VERSION"),console.log(a.data.platformVersion),this.sendRequestPromised(App.CONFIG.api.url+"/openSession",a).then(function(a){console.log(a),a.user&&(this.controllerFor("user").updateUser(a.user,a.tags),this.setProperties({locationId:a.user.school,location:App.SchoolModel.find({locationId:a.user.school}).objectAt(0).get("name")}))})},setupConfig:function(){var a=this.retrieveAppSetting("config")||{};this.set("location",a.location||null),this.set("locationId",a.locationId||0),this.set("parentType",a.parentType||null),this.set("authToken",a.authToken||null),this.set("token",a.token||null),this.set("deviceId",a.deviceId||null),this.set("receivePushNotifications","undefined"!=typeof a.receivePushNotifications?a.receivePushNotifications:!0),this.config=a},updateLocalStore:function(){var a=this.get("config");a.location=this.get("location"),a.locationId=this.get("locationId"),a.parentType=this.get("parentType"),a.authToken=this.get("authToken"),a.token=this.get("token"),a.deviceId=this.get("deviceId"),a.receivePushNotifications=this.get("receivePushNotifications"),this.set("config",a),this.storeAppSetting("config",a)}.observes("location","locationId","parentType","authToken","token","deviceId","receivePushNotifications"),updateRemoteUserSettings:function(){window.push&&(this.get("receivePushNotifications")?window.push.enablePush():window.push.disablePush())}.observes("receivePushNotifications"),storeAppSetting:function(a,b){var c="string"!=typeof b?JSON.stringify(b):b;window.localStorage.setItem(a,c)},retrieveAppSetting:function(a){var b=window.localStorage.getItem(a);return b?JSON.parse(b):null},resetConfig:function(){this.setProperties({authToken:null,token:null,deviceId:null,receivePushNotifications:!0,location:null,locationId:null,parentType:null})}})}(),function(){App.ApplicationInfoFeesController=App.StaticContentController.extend({contentId:"applicationInfoFees"})}(),function(){App.ApplicationInfoGrades1To5Controller=App.StaticContentController.extend({contentId:"applicationInfoGrades1To5"})}(),function(){App.ApplicationInfoGrades6To8Controller=App.StaticContentController.extend({contentId:"applicationInfoGrades6To8"})}(),function(){App.ApplicationInfoKindergartenController=App.StaticContentController.extend({contentId:"applicationInfoKindergarten"})}(),function(){App.CalendarController=Ember.ArrayController.extend({numEvents:0,isAre:"are",eventWording:"events",monthViewing:"",datePicked:function(a){App.Event.find({date:a});this.transitionToRoute("calendar.day",a)},setMonth:function(a){this.set("monthViewing",a)},setEventIndicator:function(){var a=moment(new Date).format("DD-MM-YYYY"),b=0;this.get("content").get("length")>0&&(this.get("content").forEach(function(c){var d=moment.parseZone(c.get("start")).format("DD-MM-YYYY");a===d&&(b+=1)}),this.setProperties({numEvents:b,isAre:1!==b?"are":"is",eventWording:1!==b?"events":"event"}))}.observes("content.@each")})}(),function(){App.CalendarDayController=Ember.ArrayController.extend({currentDate:function(){var a=this.get("content").objectAt(0),b=null;return a?(b=a.get("start"),moment.parseZone(b).format("MMM D, YYYY")):void 0}.property("content")})}(),function(){App.ContactController=Ember.Controller.extend(App.SendMail,{needs:["user"],pageTitle:"Contact",hasBackBtn:!0,isLoading:!1,error:!1,success:!1,school:"",locations:Ember.ArrayProxy.create({content:Ember.A(App.SchoolModel.find())}),init:function(){var a=this.get("controllers.user");this._super(),this.setProperties({parentName:a.get("parentName"),email:a.get("email")})},reset:function(){this.setProperties({parentName:"",email:"",phone:"",message:""})},submit:function(){var a=this.get("email"),b="";this.set("isLoading",!0),this.set("error",!1),this.set("success",!1),b+="Parent Name: "+this.get("parentName")+"\n",b+="Child DOB: "+this.get("dob")+"\n",b+="Email: "+a+"\n",b+="Phone Number: "+this.get("phone")+"\n",b+="Location: "+this.get("school").get("name")+"\n\n",b+=this.get("message"),this.sendMail(a,b,"contact")},setSuccess:function(){this.set("isLoading",!1),this.set("success",!0),this.reset()},setError:function(){this.set("error",!0),this.set("isLoading",!1)}})}(),function(){App.CurrentController=Ember.Controller.extend({navOpen:!1,hasSideNav:!0,showPtaNav:!1,toggleNav:function(){this.toggleProperty("navOpen")}})}(),function(){App.CurrentContactController=Ember.ArrayController.extend({schools:App.SchoolModel.find()})}(),function(){App.CurrentHomeController=App.StaticContentController.extend(App.SchoolImage,{contentId:"currentHome"})}(),function(){App.CurrentJotFormController=Ember.ArrayController.extend({jotForms:function(){return App.JotForm.find()}.property()})}(),function(){App.CurrentNewsletterController=Ember.ObjectController.extend(App.Ajax,{needs:["current"],newsletter:null,category:null,hasCat:{},init:function(){this._super(),this.retrieveNewsletter()},retrieveNewsletter:function(){var a=localStorage.getItem("newsletter");this.set("newsletter",JSON.parse(a)||{}),this.setVisableCats(this.newsletter.categories),this.checkForNewNewsletter()},checkForNewNewsletter:function(){var a=localStorage.getItem("config")?JSON.parse(localStorage.getItem("config")):{},b=App.CONFIG.api.url+"/newsletter",c={method:"POST",data:{}};c.data[App.CONFIG.api.DEVICE_ID_HEADER]=a.deviceId||"",c.data[App.CONFIG.api.AUTH_TOKEN_HEADER]=a.token||"",this.sendRequestPromised(b,c).then(function(a){this.get("newsletter").issueNumber;this.updateNewsLetter(a)})},updateNewsLetter:function(a){this.set("newsletter",a),this.setVisableCats(a.categories),localStorage.setItem("newsletter",JSON.stringify(a))},setCategory:function(a){var b=this;$.each(this.get("newsletter").categories,function(){this.id===a&&(b.get("controllers.current").setProperties({newsletterBackBtn:!0,hasSideNav:!1}),b.set("category",this))})},setVisableCats:function(a){var b={};"undefined"!=typeof a&&a.length>0&&$.each(a,function(a,c){b["cat"+c.id]=!0}),this.set("hasCat",b)}})}(),function(){App.CurrentPtaController=Ember.ArrayController.extend({isDocs:!0,isMsgs:!1,messages:function(){return App.PtaMessage.find()}.property()})}(),function(){App.CurrentSafeArrivalController=Ember.Controller.extend(App.SendMail,{children:[],isLoading:!1,error:!1,success:!1,errorMsg:"",formErrorMsg:"",reset:function(){this.get("children");this.set("message","")},submit:function(){var a=JSON.parse(localStorage.getItem("user")||"{}").email,b="",c=this.get("children"),d=!1,e="Please select at least one child. ";this.setProperties({isLoading:!0,error:!1,success:!1,formErrorMsg:""}),b+="Parent Name: "+this.get("parentName")+"\n\n",b+="Children:\n";for(var f=0,g=c.length;g>f;f++)c[f].isSelected&&(b+="    - "+c[f].name+"("+c[f].grade+c[f].section+")\n",d=!0,e="");b+="\n",b+=this.get("message"),!this.get("name"),this.get("message")||(d=!1,e+="You must provide your name and a message"),d?this.sendMail(a,b,"safeArrival"):this.setProperties({isLoading:!1,formErrorMsg:e})},setSuccess:function(){this.set("isLoading",!1),this.set("success",!0),this.reset()},setError:function(){this.set("error",!0),this.set("isLoading",!1)}})}(),function(){App.EventsEventController=Ember.ObjectController.extend({isUpcoming:function(){var a=moment.parseZone(this.get("start")).format("YYYY-MM-DD"),b=moment().format("YYYY-MM-DD"),c=window.device?parseInt(window.device.version+""):0;return window.device&&"BlackBerry"===window.device.platform&&10>c?!1:moment(b).isBefore(a)||moment(b).isSame(a)}.property("start","end")})}(),function(){App.LoginController=Ember.Controller.extend(App.Ajax,{needs:["application","user","settings"],hasBackBtn:!0,pageTitle:"Sign In",authError:!1,isLoading:!1,authenticateUser:function(){if(this.set("authError",!1),this.get("password")){var a=App.CONFIG.api.url+"/login",b={method:"POST",data:{authenticationToken:this.get("controllers.application").get("authToken"),code:this.get("password")}};b.data[App.CONFIG.api.DEVICE_ID_HEADER]=this.get("controllers.application").get("deviceId"),this.sendRequest(a,b,this.handleLoginSuccess,this.handleLoginError),this.set("isLoading",!0)}else this.set("validEmail",!1),this.set("message","You must fill in your PIN")},handleLoginSuccess:function(a){var b=this.get("controllers.user"),c=this.get("controllers.application"),d=App.SchoolModel.find({locationId:a.user.school}).objectAt(0);console.log(a),c.setProperties({token:a.authorizationToken,parentType:"current",location:d.get("name"),locationId:a.user.school,loggingIn:!1}),b.updateUser(a.user,a.tags),this.get("controllers.settings").setProperties({parentType:"current",location:d.get("name"),locationId:a.user.school}),this.transitionToRoute("current.home"),this.set("isLoading",!1)},handleLoginError:function(){this.set("authError",!0),this.set("isLoading",!1)}})}(),function(){App.ProspectiveController=Ember.Controller.extend({navOpen:!1,hasSideNav:!0,pageClass:function(){var a=this.get("pageTitle").toLowerCase().split(" ").join("-");return"page-"+a}.property("pageTitle")})}(),function(){App.ProspectiveContactController=Ember.ArrayController.extend({schools:App.SchoolModel.find()})}(),function(){App.ProspectiveHomeController=App.StaticContentController.extend(App.SchoolImage,{contentId:"prospectiveHome"})}(),function(){App.ProspectiveWelcomeController=App.StaticContentController.extend({contentId:"prospectiveWelcome"})}(),function(){App.SettingsController=Ember.Controller.extend({needs:["application","user"],pageTitle:"Settings",hasDoneBtn:!0,user:function(){return this.get("controllers.user").getProperties("children","parentName","location","email")}.property(),hasPushNotifications:function(){return window.device&&"BlackBerry"===window.device.platform?parseInt(window.device.version)>=10:!0}.property(),showRefresh:!1,schools:App.SchoolModel.find(),location:function(){return this.get("controllers.application").get("location")}.property(),parentType:function(){return this.get("controllers.application").get("parentType")}.property(),receivePushNotifications:function(){return this.get("controllers.application").get("receivePushNotifications")}.property(),updateAppSettings:function(){var a=this.get("controllers.application");a.setProperties({location:this.get("location"),parentType:this.get("parentType"),receivePushNotifications:this.get("receivePushNotifications"),locationId:"Viewmount Branch"===this.get("location")?1:2})}.observes("location","parentType","receivePushNotifications"),currentParent:function(){return"current"===this.get("parentType")}.property("parentType"),setRefresh:function(){var a=App.SchoolModel.find(this.get("location")).get("locationId");this.get("controllers.user").setUATags(["PP"+a]),this.set("showRefresh",!0)}.observes("location"),refresh:function(){this.get("controllers.application").set("isLoading",!0),this.transitionToRoute("index"),setTimeout(function(){window.location.reload()},250),this.set("showRefresh",!1)}})}(),function(){App.SetupController=Ember.Controller.extend({pageTitle:"Welcome & Setup"})}(),function(){App.SetupRequestLoginController=Ember.Controller.extend(App.Ajax,{needs:["application","login"],isLoading:!1,requestPin:function(){if(this.get("email")){this.setProperties({message:null});var a=App.CONFIG.api.url+"/emailverify",b={method:"POST",data:{email:this.get("email")}};b.data[App.CONFIG.api.DEVICE_ID_HEADER]=this.get("controllers.application").get("deviceId"),this.set("isLoading",!0),this.sendRequest(a,b,this.handleRequestSuccess,this.handleRequestError)}else this.setProperties({message:"Please provide a valid e-mail address.",validEmail:!1})},handleRequestSuccess:function(a){this.get("controllers.application").set("authToken",a.authenticationToken),this.set("isLoading",!1),this.get("controllers.login").set("message",a.message||"").set("validEmail",!0),this.transitionToRoute("login")},handleRequestError:function(){this.setProperties({message:'We did not find your e-mail in our records. Please contact us by e-mail at <a href="mailto:app@bialik.ca">app@bialik.ca</a> so that we may provide you with assistance.',validEmail:!1,isLoading:!1})}})}(),function(){App.UserController=Ember.ObjectController.extend({parentName:"",email:"",location:"",children:[],tags:[],init:function(){this._super(),this.retrieveUser()},saveUser:function(){var a={parentName:this.get("parentName"),email:this.get("email"),location:this.get("location"),children:this.get("children"),tags:this.get("tags")};localStorage.setItem("user",JSON.stringify(a))}.observes("parentName","email","locations","children","tags"),retrieveUser:function(){var a=localStorage.getItem("user");a&&(a=JSON.parse(a),this.setProperties({parentName:a.parentName,email:a.email,location:a.location,children:a.children,tags:a.tags}))},updateUser:function(a,b){this.setUATags(b||[""]),this.setProperties({parentName:a.name,email:a.email,location:App.SchoolModel.find({locationId:a.school}).objectAt(0).get("name"),children:a.children,tags:b})},setUATags:function(a){window.push&&window.push.setTags(a,function(){})},resetSettings:function(){this.setUATags([""]),this.setProperties({parentName:null,email:null,location:null,children:null,tags:[]})}})}(),function(){App.AccordionHeading=Em.View.extend({tagName:"a",attributeBindings:["data-toggle","data-parent"],didInsertElement:function(){this.$().attr("href","#collapse-"+this.get("_parentView.contentIndex")),0!==this.get("_parentView.contentIndex")&&this.$().addClass("collapsed")}}),App.AccordionBody=Em.View.extend({tagName:"div",classNames:["accordion-body","collapse"],didInsertElement:function(){0===this.get("_parentView.contentIndex")&&this.$().addClass("in"),this.$().attr("id","collapse-"+this.get("_parentView.contentIndex"))}})}(),function(){App.CalendarTool=Em.View.extend({tagName:"div",attributeBindings:["id","events","owner"],classNamesBindings:["class"],didInsertElement:function(){var a=this,b=new Date(this.get("controller").get("monthViewing"));this.$().fullCalendar({header:{left:"prev",center:"title",right:"next"},weekMode:"variable",editable:!1,events:a.get("controller").get("model").filter(function(){return!0}),eventRender:function(b){return a.$().find('[data-date="'+moment.parseZone(b.start).format("YYYY-MM-DD")+'"]').addClass("has-event"),!1},eventDataTransform:function(a){var b={};return b=a.get?a.getProperties("title","start"):a,b.start&&(b.start=moment.parseZone(b.start).format("YYYY-MM-DD")),b.end&&(b.end=moment.parseZone(b.end).format("YYYY-MM-DD")),b}}),this.$().on("click",".fc-button",function(){a.get("controller").send("setMonth",a.$().fullCalendar("getDate"))}),this.$().on("click",".fc-day",function(){$(this).hasClass("has-event")&&a.get("controller").send("datePicked",$(this).data("date"))}),b.getFullYear()&&"undefined"!=typeof b.getMonth()&&this.$().fullCalendar("gotoDate",b.getFullYear(),b.getMonth())}})}(),function(){App.Mailto=Ember.View.extend({tagName:"a",attributeBindings:["href"],classNames:["btn","btn-primary","btn-large","btn-block"],href:function(){return"mailto:"+this.get("contactEmail")}.property()})}(),function(){App.ProspectiveView=Ember.View.extend({})}(),function(){App.RadioButton=Ember.View.extend({tagName:"input",type:"radio",attributeBindings:["name","type","value","checked:checked:"],click:function(){this.set("selection",this.$().val())},checked:function(){return this.get("value")==this.get("selection")}.property()})}(),function(){App.TelLink=Ember.View.extend({tagName:"a",attributeBindings:["href"],classNames:["btn","btn-primary","btn-large","btn-block"],href:function(){return"tel:"+this.get("contactTel")}.property()})}(),function(){App.ToggleButton=Ember.View.extend({tagName:"button",type:"submit",attributeBindings:["isLoading","data-loading-text"],classNames:["btn","btn-primary","btn-large","btn-block"],click:function(){this.set("selection",this.$().val())},toggle:function(){var a=this.get("isLoading")?"loading":"reset";this.$().button(a)}.observes("isLoading")})}(),function(){function a(){if(window.cordova){var a=parseInt(window.device.version+"");window.cordova.platformId&&"blackberry10"===window.cordova.platformId&&(window.device.platform="BlackBerry"),"Android"===window.device.platform?cordova.addConstructor(calendarPlugin.install):"iOS"===window.device.platform?cordova.addConstructor(calendarPluginIos.install):"BlackBerry"===window.device.platform&&10>a?($("body").addClass("bb bb-lt-10"),$("body, html").css({width:screen.width,height:screen.height}),$("head").append("<style>.page .body-cont { height: "+screen.height+"px }</style>"),$('meta[name="viewport"]').attr("content","width=device-width, target-densitydpi=device-dpi, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no")):"BlackBerry"===window.device.platform&&a>=10&&(window.push=new App.BbPush)}$.post(App.CONFIG.api.checkUrl).done(function(a){App.CONFIG.api.url=a.location+"/api",localStorage.setItem("serviceUrl",a.location+"/api"),b()}).fail(function(){var a=localStorage.getItem("serviceUrl");App.CONFIG.api.url=a||App.CONFIG.api.url,b()}),$("#app-loading-cont").remove()}function b(){App.utils={},App.advanceReadiness(),FastClick.attach(document.body),$("body").on("click touchstart",'a[target="_blank"]',function(a){a.preventDefault(),window.loadUrl($(a.target).attr("href"))}),$(window).on("resize",function(){var a=$(".section-nav");a.css({webkitOverflowScrolling:"auto",overflow:"hidden"}),setTimeout(function(){a.css({webkitOverflowScrolling:"touch",overflow:"auto"})},100)}),$("#app-loading-cont").remove()}App.deferReadiness(),App.Router=Ember.Router.extend({}),App.Router.map(function(){this.resource("setup",function(){this.route("locationSelect",{path:"location-select"}),this.route("parentType",{path:"parent-type"}),this.route("requestLogin",{path:"request-login"})}),this.resource("prospective",function(){this.route("home"),this.route("welcome"),this.route("schoolLife",{path:"school-life"}),this.resource("applicationInfo",{path:"application-info"},function(){this.route("applicationForm",{path:"application-form"}),this.route("brochure"),this.route("kindergarten"),this.route("grades1To5",{path:"grades-1-5"}),this.route("grades6To8",{path:"grades-6-8"}),this.route("fees")}),this.resource("bookRecommendations",{path:"book-recommendations"},function(){this.route("book",{path:":book_id"})}),this.route("contact")}),this.resource("current",function(){this.route("home"),this.route("safeArrival",{path:"safe-arrival"}),this.route("newsletter"),this.route("pta"),this.resource("ptaMessage",{path:"pta-message/:id"}),this.resource("calendar",function(){this.route("day",{path:"day/:date"})}),this.route("jotForm",{path:"JotForm"}),this.resource("events",{path:"events"},function(){this.route("event",{path:":id"})}),this.route("contact")}),this.route("settings"),this.route("contact"),this.route("login")}),window.cordova?(document.addEventListener("deviceready",a,!1),window.loadUrl=function(a){var b=parseInt(window.device.version+"");if("BlackBerry"===window.device.platform&&10>b){var c=new blackberry.invoke.BrowserArguments(a);blackberry.invoke.invoke(blackberry.invoke.APP_BROWSER,c)}else window.open(a,"_system");$("#app-loading-cont").remove()}):(a(),window.loadUrl=function(a){window.open(a,"_blank")},$("#app-loading-cont").remove())}();